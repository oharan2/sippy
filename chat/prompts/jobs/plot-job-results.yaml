# Create a stacked bar chart visualization of job results
name: plot-job-results
description: Generate a stacked bar chart showing job outcomes over time, grouped by job result status
arguments:
  - name: variants
    description: Variant(s) to filter job records by (e.g., "gcp", "aws", "metal")
    required: true
    type: array
    autocomplete: variants
  - name: release
    description: Release version to filter by (e.g., "4.15", "4.16")
    required: false
    type: string
    autocomplete: releases
  - name: days
    description: Number of days to look back for job results
    required: false
    type: integer
    default: 7
prompt: |
  Create a stacked bar chart visualization of job results for the following criteria:
  
  **Filter Parameters:**
  * Variants: {{ variants | join(', ') }}
  {% if release %}* Release: {{ release }}{% endif %}
  * Time Period: Last {{ days }} days
  
  ## Instructions:
  
  1. **Data Collection:**
     - Query job records matching the specified variant(s){% if release %} and release version{% endif %}
     - Filter for jobs that completed within the last {{ days }} days
     - Group results by outcome (Success, Failure, Aborted, etc.)
  
  2. **Chart Specifications:**
     - **Chart Type**: Stacked bar chart
     - **X-axis**: Time periods
     - **Y-axis**: Count of job runs
     - **Stack Segments**: Different colors for each job outcome:
       * Success (green)
       * Failure (red)
       * Other states as needed
     - **Legend**: Include a legend explaining the color coding for each outcome
  
  3. **Summary Statistics:**
     After the chart, provide:
     - Total number of job runs analyzed
     - Overall pass rate across all jobs
     - Jobs with the highest failure rates (top 5)
     - Any notable patterns or trends in the data